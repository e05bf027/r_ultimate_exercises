---
title: "Data Filtering: Exercise"
author: "David Hannon"
date: "30 December 2021"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, warning = F, message = F)
```

```{r}
library(tidyverse)
library(babynames)
```

In this exercise you will work extensively on dplyr filtering and selection.

# Data Preparation

We will work with dataset "babynames" from the package with the same name.

```{r}
# install.packages('babynames')
library(babynames)

data("babynames")
babynames %>% glimpse
```

# Filtering

1. Filter for year 2015.

2. Filter for all names that have a capital letter "B". Help: take a look at "str_detect()".

3. Filter for male names.

4. Take only names into account which have more than 100 observations.

5. Show the Top 10 in decreasing order.

6. Keep only the columns "name" and "prop"

```{r}
# Filter for year 2015
babynames_2015 <- babynames %>% 
  filter(year == 2015)

# Filter for all names that have a capital letter "B"
babynames_B <- babynames %>% 
  filter(str_detect(name, "B"))

# Filter for male names
babynames_male <- babynames %>% 
  filter(sex == "M")

# Take only names into account which have more than 100 observations
babynames_100 <- babynames %>% 
  filter(n > 100)

# Show the Top 10 in decreasing order
babynames_top10 <- babynames %>% 
  arrange(desc(n)) %>%
  slice_max(n = 10, order_by = n)

# Keep only the columns "name" and "prop"
babynames_cols <- babynames %>% 
  select(name, prop)

# Overall
babynames_filt <- babynames %>% 
  filter(year == 2015) %>% 
  filter(str_detect(name, "B")) %>% 
  filter(sex == "M") %>% 
  filter(n > 100) %>% 
  arrange(desc(n)) %>%
  slice_max(n = 10, order_by = n) %>% 
  select(name, prop)
  
```

